<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

  <!-- InstanceBegin template="../../../../../web-data/Templates/Help_Contetns_enTitle.dwt" -->

    <head>
      <meta name="keywords" content="InsertionLocator, AppleScript, insertion location" />
      <meta http-equiv="content-type" content="text/html;charset=utf-8" />
      <title>InsertionLocator</title>
      <!-- #BeginHeadLocked "" -->
        <link href="../03_history/assets/default.css" type="text/css" rel="styleSheet" />
        <link href="../03_history/assets/help.css" type="text/css" rel="stylesheet" media="screen" />
        <script type="text/javascript" language="JavaScript1.4" src="../03_history/assets/SmartHeader.js"></script>
      <!-- #EndHeadLocked -->
      <link href="assets/AppleScript.css" rel="stylesheet" type="text/css" media="all" />
    </head>

    <body>
      <p id="smartheader" style="visibility:hidden"><!-- InstanceBeginEditable name="SmartHeader" --><a href="index.html">InsertionLocator Help</a>
		<!-- InstanceEndEditable --></p>
      <!-- InstanceBeginEditable name="Body" -->
        <h1>InsertionLocator</h1>
        <h2><a id="what" name="what"></a>What</h2>
        <p>InsertionContainer is an AppleScript module to obtain insertion/selected location in Finder  with smarter way than Finder does.</p>
        <p>Finder's insertion location property always means the top level folder of Finder window. This behavior is not enough in same cases, for example expanded subfolder shown in a list view window can not be the insertion location.</p>
        <p>InsertionLocator allow following behaviors.</p>
        <ul>
          <li>If a file is selected, the container of the file can be insertion location.
					
					
					
          <li>The selected folder can be insertion location.
					
					
					
          <li>The only selected folder which is expanded subfolder in the list view window can be insertion location.
				
				
				
        </ul>
        <p>These behaivor can be customizable to meet your application.</p>
        <!--begin abs_link-->
        <p>GUI Scripting must be enabled for full features of InsertionLocator. <a href="http://homepage.mac.com/tkurita/scriptfactory/en/contents.html#GUIScriptingChecker">GUIScriptingChercker</a> is useful to check availability  of </p>
        <!--end abs_link-->
        <h2><a id="sample" name="sample"></a>Sample</h2>
        <div class="sourceCode">
          <div>
            <span class="langKeyword">property</span> <span class="appKeyword">parent</span><span class="normal"> : </span><span class="userDefine">proxy</span><span class="normal">() </span><span class="langKeyword">of</span> <span class="appKeyword">application</span><span class="normal"> (</span><span class="langKeyword">get</span><span class="normal"> &quot;ModuleLoader&quot;)</span></div>
          <div>
            <span class="langKeyword">property</span> <span class="userDefine">GUIScriptingChecker</span><span class="normal"> : </span><span class="userDefine">load</span><span class="normal">(&quot;GUIScriptingChecker&quot;)</span></div>
          <div>
            <span class="langKeyword">property</span> <span class="userDefine">InsertionLocator</span><span class="normal"> : </span><span class="userDefine">load</span><span class="normal">(&quot;InsertionLocator&quot;)</span></div>
          <br />
          <div>
            <span class="langKeyword">on</span> <span class="appKeyword">run</span></div>
          <div style="text-indent:4ex;">
            <span class="langKeyword">if</span> <span class="langKeyword">not</span> <span class="userDefine">do</span><span class="normal">() </span><span class="langKeyword">of</span> <span class="userDefine">GUIScriptingChecker</span> <span class="langKeyword">then</span></div>
          <div style="text-indent:8ex;">
            <span class="normal">--</span><span class="comment"> GUI Scripting is disable</span></div>
          <div style="text-indent:8ex;">
            <span class="langKeyword">return</span></div>
          <div style="text-indent:4ex;">
            <span class="langKeyword">end</span> <span class="langKeyword">if</span></div>
          <br />
          <div style="text-indent:4ex;">
            <span class="langKeyword">set</span> <span class="userDefine">a_locator</span> <span class="langKeyword">to</span> <span class="appKeyword">make</span> <span class="userDefine">InsertionLocator</span></div>
          <div style="text-indent:4ex;">
            <span class="appKeyword">log</span> <span class="userDefine">a_locator</span><span class="normal">'s </span><span class="userDefine">do</span><span class="normal">()</span></div>
          <br />
          <div style="text-indent:4ex;">
            <span class="normal">--</span><span class="comment"> Folders whose contents are not shown should not be insertion location</span></div>
          <div style="text-indent:4ex;">
            <span class="userDefine">a_locator</span><span class="normal">'s </span><span class="userDefine">set_allow_closed_folder</span><span class="normal">(</span><span class="appKeyword">false</span><span class="normal">)'s </span><span class="userDefine">do</span><span class="normal">()</span></div>
          <div>
            <span class="langKeyword">end</span> <span class="appKeyword">run</span></div>
          <div style="position: relative; top: -2em; float: right; text-align: right;" class="scriptButton" >
            <input type="button" value="sample.scpt" onclick="location.href='applescript://com.apple.scripteditor?action=new%26script=property%20parent%20:%20proxy()%20of%20application%20(get%20%22ModuleLoader%22)%0Aproperty%20GUIScriptingChecker%20:%20load(%22GUIScriptingChecker%22)%0Aproperty%20InsertionLocator%20:%20load(%22InsertionLocator%22)%0A%0Aon%20run%0A%09if%20not%20do()%20of%20GUIScriptingChecker%20then%0A%09%09--%20GUI%20Scripting%20is%20disable%0A%09%09return%0A%09end%20if%0A%09%0A%09set%20a_locator%20to%20make%20InsertionLocator%0A%09log%20a_locator%27s%20do()%0A%09%0A%09--%20Folders%20whose%20contents%20are%20not%20shown%20should%20not%20be%20insertion%20location%0A%09a_locator%27s%20set_allow_closed_folder(false)%27s%20do()%0Aend%20run'" /></div>
        </div>
      <!-- InstanceEndEditable -->
      <div class="footer">
        <p>This page was last built on <csobj format="MedDate" h="11" region="0" t="DateTime" w="67">Wed, Jan 21, 2009</csobj> ; <csobj format="LongTime" h="11" region="0" t="DateTime" w="43">9:09:06 PM</csobj> . Thanks for checking it out!</p>
      </div>
    </body>

  <!-- InstanceEnd -->

</html>